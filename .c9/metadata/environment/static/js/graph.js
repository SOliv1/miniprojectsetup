{"changed":true,"filter":false,"title":"graph.js","tooltip":"/static/js/graph.js","value":"\nqueue()\n    .defer(d3.csv, \"data/Salaries.csv\")\n    .await(makeGraphs);\n    \nfunction makeGraphs(error, salaryData) {\n    var ndx = crossfilter(salaryData);\n    \n    show_discipline_selector(ndx);\n    show_gender_balance(ndx);\n    show_average_salary(ndx);\n    \n    dc.renderAll();\n}\n\nfunction show_discipline_selector(ndx) {\n    var dim = ndx.dimension(dc.pluck('discipline'));\n    var group = dim.group();\n    \n    dc.selectMenu(\"#discipline-selector\")\n        .dimension(dim)\n        .group(group);\n}\n\nfunction show_gender_balance(ndx) {\n    var dim = ndx.dimension(dc.pluck('sex'));\n    var group = dim.group();\n    \n    dc.barChart(\"#gender-balance\")\n        .width(400)\n        .height(300)\n        .margins({top: 10, right: 50, bottom: 30, left: 50})\n        .dimension(dim)\n        .group(group)\n        .transitionDuration(500)\n        .x(d3.scale.ordinal())\n        .xUnits(dc.units.ordinal)\n        .xAxisLabel(\"Gender\")\n        .yAxis().ticks(20);\n}\n\nfunction show_average_salary(ndx) {\n    var dim = ndx.dimension(dc.pluck('sex'));\n    \n    function add_item(p, v) {\n        p.count++;\n        p.total += v.salary;\n        p.average = p.total / p.count;\n        return p;\n    }\n\n    function remove_item(p, v) {\n        p.count--;\n        if(p.count == 0) {\n            p.total = 0;\n            p.average = 0;\n        } else {\n            p.total -= v.salary;\n            p.average = p.total / p.count;\n        }\n        return p;\n    }\n    \n    function initialise() {\n\n        return {count: 0, total: 0, average: 0};\n    }\n\n    var averageSalaryByGender = dim.group().reduce(add_item, remove_item, initialise);\n\nconsole.log = averageSalaryByGender;\n\n    \n}\n\n","undoManager":{"mark":-2,"position":5,"stack":[[{"start":{"row":70,"column":34},"end":{"row":70,"column":35},"action":"insert","lines":[";"],"id":663}],[{"start":{"row":70,"column":11},"end":{"row":70,"column":12},"action":"remove","lines":["("],"id":664}],[{"start":{"row":70,"column":32},"end":{"row":70,"column":33},"action":"remove","lines":[")"],"id":665}],[{"start":{"row":70,"column":11},"end":{"row":70,"column":12},"action":"insert","lines":[" "],"id":666}],[{"start":{"row":70,"column":12},"end":{"row":70,"column":13},"action":"insert","lines":["="],"id":667}],[{"start":{"row":70,"column":13},"end":{"row":70,"column":14},"action":"insert","lines":[" "],"id":668}]]},"ace":{"folds":[],"scrolltop":929,"scrollleft":0,"selection":{"start":{"row":70,"column":36},"end":{"row":70,"column":36},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":50,"state":"no_regex","mode":"ace/mode/javascript"}},"timestamp":1568133899319}